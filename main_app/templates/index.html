{% extends 'base.html' %}
{% load static %}

{% block js %}
    <script src="{% static 'pkmn.js' %}" defer></script>
{% endblock %}

{% block title %}| Home{% endblock %}


<!------------------------ Body ------------------------>
{% block content %}
<div class="column">
    <h2>Popular Pokemon</h2>
    <div class="card-grid">
        {% for pkmn in all_pokemon %}
        <a href="/{{pkmn.id}}">
            <div class="card">
                <h3>#{{pkmn.id}}</h3>
                <img src="{{pkmn.art_url}}" alt="{{pkmn.name}}'s official art">
                <h2>{{pkmn.name}}</h2>
            </div>
        </a>
        {% endfor %}
    </div><!-- card-grid -->
</div><!-- column -->


<!-- Recent Posts -->
<div class="column feed">
    <ul class="list-group">
        <li class="list-group-head">
            <h3>Recent Posts</h3>
        </li>
        {% for post in posts reversed %}
        <li class="list-group-item">
            <div class="comment-head">
                <img src="{% static '' %}img/default-profiles/{{post.added_by.default_img}}.png" alt="profile pic" class="comments-user-img">
                <div>
                    <a href="/profile/{{post.added_by.id}}"><h5>{{post.added_by.username}}</h5></a>
                    <small>{{post.created_at | timesince}} ago</small>
                </div>
                <!-- Likes and Like Counter -->
                {% if "userid" not in request.session %}
                <span class="likes">&#10084; {{post.likes.all|length}}</span>
                {% elif user not in post.likes.all %}
                <a href="/profile/{{post.id}}/like_post" class="likes">&#10084; {{post.likes.all|length}}</a>
                {% else %}
                <a href="/profile/{{post.id}}/unlike_post" class="likes" style="color: #009DF1;">&#10084; {{post.likes.all|length}}</a>
                {% endif %}
            </div>
            <p>{{post.content}}</p>
            <span class="comment-count"> 
                {% if not post.comments.all|length %} 
                    <!-- Display Nothing -->
                {% elif post.comments.all|length == 1 %}
                    {{post.comments.all|length}} Comment
                {% else %} 
                {{post.comments.all|length}} Comments 
                {% endif %}
            </span>
        </li>
        {% empty %}
        <li class="list-group-item">
            <h5>No updates yet!</h5>
        </li>
        {% endfor %}
    </ul>

    <ul class="list-group">
        <li class="list-group-head">
            <h3>Recent Reviews</h3>
        </li>
        {% for review in reviews reversed %}
        <li class="list-group-item">
            <a href="/{{review.pkmn.id}}"><h5>{{review.pkmn.name | title}}</h5></a>
            <span class="n{{review.rating}} star"></span>
            <p>{{review.content}}
            </p>
            <p><a href="/profile/{{review.added_by.id}}">{{review.added_by.username}}</a>  <small>{{review.created_at | timesince}} ago</small></p>
        </li>
        {% empty %}
        <li class="list-group-item">
            <h5>No reviews yet!</h5>
        </li>
        {% endfor %}
    </ul>
</div>


{% endblock %}